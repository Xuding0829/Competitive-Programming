## 代码规范

2023.1.26 初版

2023.3.7 稍作修改

### **前言**

参考了 Menci, jiangly, SSSR, tourist 等大神的代码风格

以及 煎饼鸽鸽、杨神 等校内神仙一年以来的代码风格的转变

### **概览**

所有的 `#include` 放在开头

头文件后是所有的 `using` 引用

接着是声明 **常量** 和 **全局变量**

然后是 **全局函数** 和 **全局类**

`main()` 函数放在 **最后**

左大括号 `{` **不换行**，前跟一个字符

用 **空行** 分割不同的代码块

示例：

```C++
#include <iostream>
#include <utility>

using i64 = long long;
using pii = std::pair<int, int>;

const int P = 998244353;
const int MAXN = 1E3 + 10;

int dp[N][N];

template<class T>
T power(T a, i64 b) {
    T res = 1;
    // ...
    return res;
}
struct Z {
    // ...
};

int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);

    int n;
    std::cin >> n;

    // ...

    return 0;
}
```

### **头文件**

C 标准库的头文件 **必须是** `c` 开头的形式而不是 `.h` 结尾的形式

C++ 标准库头文件放在 C 标准库头文件 **之后**

（如果有其他头文件的话）其他头文件放在最后

### **缩进**

一律使用 **四空格** 或等价的 `Tab` 表示缩进

### **空格的使用**

`if`, `for`, `while`, `return` 等关键字后 **留一个空格**

逗号 `,` 与 `for` 中的分号 `;` 后面 **必须** 有一个空格，前面 **不能** 有空格

冒号 `:` 前后 **必须** 各一个空格， 三目运算符同理

单目运算符 `++`, `--` 等，前后 **不能** 有空格

`::`, `->`, `.`等符号前后 **不留空格**

`->` 表示 **函数显式声明** 的时候前后留空格

指针符号 `*`, 引用符号 `&` 左留空格，右不留空格

### **大括号**

左大括号 **不换行**，右大括号多数情况下换行

大部分情况下右大括号换行，且与上一级代码块 **缩进相同**

通常在 **类、结构体** 中定义的较短的函数时，一对大括号可不换行

若一对大括号在同一行，酌情在前后增加空格以提高易读性

示例：

```C++
// 少数情况可不换行
bool same(int x, int y) { return leader(x) == leader(y); }

// 多数情况下换行
if (a == b) {
    // ...
} else if (a == c) {
    // ...
} else {
    // ...
}
```

### **行**

除 `for` 中的三个语句外，每行不能有超过一个语句；如果需要一行内求值多个表达式，可以使用等效的逗号表达式替代

多个意义独立的代码块之间应该用空行隔开

右花括号前不应该有多余的空行

不应该有两个连续的空行

非空行尾不应该有多余的空格

所有的 `#include` 指令之后必须有一个空行

函数、成员函数、结构体、全局变量块之间必须用空行隔开

### **函数**

`main` 函数的返回值类型必须是 `int`，尽量别省略 `return 0;`

空函数体使用 `{}`

定义类函数时可以写在同一行， 如 

```C++
bool same(int x, int y) { return leader(x) == leader(y); }
```

### **变量**

尽量 **不使用** 全局变量

变量必须在使用时定义，如：

```C++
int n;
std::cin >> n;

std::vector<int> a(n);
for (int i = 0; i < n; i++) {
    std::cin >> a[i];
}

int ans = 0;
```

### **命名**

所有结构体、类、函数、变量、参数名必须使用 **驼峰命名法** ，其中结构体、类名首字母必须大写，其它首字母必须小写

为方便，命名中的单词可以使用缩写，函数、变量、参数名可以用一个小写字母代替。全局数组可以命名为一个大写字母

### **其他** （待补充）

若 `if ()` , `while ()` , `for ()` 语句及之后的语句长度较短，可写同一行，如：

```C++
// 换行
for (int d = 0; d < 4; d++) {
    int tx = x + mx[d], ty = y + my[d];
    if (tx < 0 || tx >= n || ty < 0 || ty >= m) {
        continue;
    }
    // ...
}

// 不换行
for (int i = 0; i < n; i++) {
    if (!st[i]) continue;
    // ...
}

for (int i = 0; i < n; i++) {
    if (s[i] == 'a') a++;
    else b++;
    // ...
}

```

遍历数组时，若不在意下标则可使用 `for (auto[a, b] : arr)` ，如：

```C++
// Kruskal
for (auto[u, v, d] : E) {
    if (d >= k && u != v && !dsu.same(u, v)) {
        dsu.merge(u, v);
        ans += d;
    }
}

// BFS
while (!q.empty()) {
    auto[x, y] : q.front();
    q.pop();
    // ...
}
```

给 `std::sort()` 传参时， Lambda 表达式该引用的时候引用， 如：

```C++
// 不引用
std::sort(a.begin(), a.end(), [](int A, int B) {
    return std::abs(A) > std::abs(B);
});

// 引用
std::sort(ord.begin(), ord.end(), [&cnt](int A, int B) {
    return cnt[A] < cnt[B];
});
```